<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../components/iron-image/iron-image.html">
<script src="../components/gsap/src/minified/TweenMax.min.js"></script>
<script src="../components/gsap/src/minified/plugins/TextPlugin.min.js"></script>

<dom-module id="insight-overlay">
	<template>

		<div class="cull">

			<div class="top" layout horizontal>
				<div class="left" flex>

					<iron-image id="left-line-top" src="../insight-overlay/img/blue_line{{type}}.png"> </iron-image>
					<iron-image id="left-bar-top" src="../insight-overlay/img/left_bar_top{{type}}.png"> </iron-image>
					<iron-image id="left-glow" src="../insight-overlay/img/blue_glow{{type}}.png"> </iron-image>
					<iron-image id="left-logo" src="../../../assets/insight-overlay/teamlogos/{{bluelogo}}"> </iron-image>
					<div class="blue-info">
						<span id="blue-team-name"></span>
					<span id="blue-team-score"> [[bluescore]] </span>
					</div>
				</div>

				<div class="right" flex>
					<iron-image id="right-line-top" src="../insight-overlay/img/red_line{{type}}.png"> </iron-image>
					<iron-image id="right-bar-top" src="../insight-overlay/img/right_bar_top{{type}}.png"> </iron-image>
					<iron-image id="right-glow" src="../insight-overlay/img/red_glow{{type}}.png"> </iron-image>
					<iron-image id="right-logo" src="../../../assets/insight-overlay/teamlogos/{{redlogo}}"> </iron-image>
					<div class="red-info">
						<span id="red-team-name"> </span>
						<span id="red-team-score">[[redscore]]</span>
					</div>

				</div>
			</div>

		</div>
		</div>

	</template>


</dom-module>

<script>
	Polymer({
		is: 'insight-overlay',
		properties: {
			bluename: String,
			redname: String,
			bluescore: String,
			redscore: String,
			type: String

		},

		ready: function() {
			var self = this;
			var n1;
			var n2;
			var teamNames = nodecg.Replicant('teamNames');
			var teamScores = nodecg.Replicant('teamScores');
			var teamLogos = nodecg.Replicant('teamLogos');
			var fadeIn = nodecg.Replicant('fadeIn');
			var fadeOut = nodecg.Replicant('fadeOut');
			var switchImages = nodecg.Replicant('switchImages');
			var t1 = new TimelineLite();
			var t2 = new TimelineLite();
			self.type='';

			var isShowing = false;
      var imageType = 'original';

			nodecg.Replicant('teamNames').on('change', function(oldVal, newVal) {
				var t2 = new TimelineLite();
				self.bluename = teamNames.value[0];
				self.redname = teamNames.value[1];
				if (isShowing === true) {
					t2.to(('#blue-team-name'), 0.2, {
						text: self.bluename,
						ease: Linear.easeNone
					}, 0.1);
					t2.to(('#red-team-name'), 0.2, {
						text: self.redname,
						ease: Linear.easeNone
					}, 0.1);

				}
			});

			nodecg.listenFor('switchImages', function() {
				var t4 = new TimelineLite();
				if (self.type == '') {
	    	self.type='_alt';
				t4.to(('#blue-team-score'), 0, {
					left: '675px'
				}, 0);
				t4.to(('#red-team-score'), 0, {
					right: '675px'
				}, 0);
			}
				else {
					self.type = '';
					t4.to(('#blue-team-score'), 0, {
						left: '785px'
					}, 0);
					t4.to(('#red-team-score'), 0, {
						right: '785px'
					}, 0);
				}

			});

			nodecg.Replicant('teamScores').on('change', function(oldVal, newVal) {
				self.bluescore = teamScores.value[0];
				self.redscore = teamScores.value[1];
			});
			nodecg.Replicant('teamLogos').on('change', function(oldVal, newVal) {
				self.bluelogo = teamLogos.value[0];
				self.redlogo = teamLogos.value[1];
			});

			nodecg.listenFor('fadeIn', function() {
				var t1 = new TimelineLite();

				t1.to(('#left-line-top'), 0.5, {
					left: '165px'
				}, 0);
				t1.to(('#left-glow'), 0.5, {
					left: '0px'
				}, 0.6);
				t1.to(('#left-bar-top'), 0.5, {
					left: '0px'
				}, 0.5);
				t1.to(('#left-logo'), 0.5, {
					opacity: 1
				}, 1);
				t1.to(('#blue-team-name'), 1, {
					text: self.bluename,
					ease: SteppedEase.easeIn
				}, 1);
				t1.to(('#blue-team-score'), 0.2, {
					opacity: 1
				}, 2);

				t1.to(('#right-line-top'), 0.5, {
					right: '165px'
				}, 0);
				t1.to(('#right-glow'), 0.5, {
					right: '0px'
				}, 0.6);
				t1.to(('#right-bar-top'), 0.5, {
					right: '0px'
				}, 0.5);
				t1.to(('#right-logo'), 0.5, {
					opacity: 1
				}, 1);
				t1.to(('#red-team-name'), 1, {
					text: self.redname,
					ease: SteppedEase.easeIn
				}, 1);
				t1.to(('#red-team-score'), 0.2, {
					opacity: 1
				}, 2);
				isShowing = true;
			});
			nodecg.listenFor('fadeOut', function() {
				var t1 = new TimelineLite();

				t1.to(('#left-line-top'), 0.5, {
					left: '-900px'
				}, 1.1);
				t1.to(('#left-glow'), 0.2, {
					left: '-900px'
				}, 1);
				t1.to(('#left-bar-top'), 0.2, {
					left: '-900px'
				}, 0.8);
				t1.to(('#left-logo'), 0.2, {
					opacity: 0
				}, 0.7);
				t1.to(('#blue-team-name'), 0.5, {
					text: '',
					ease: SteppedEase.easeIn
				}, 0.2);
				t1.to(('#blue-team-score'), 0.2, {
					opacity: 0
				}, 0);

				t1.to(('#right-line-top'), 0.5, {
					right: '-900px'
				}, 1.1);
				t1.to(('#right-glow'), 0.2, {
					right: '-900px'
				}, 1);
				t1.to(('#right-bar-top'), 0.2, {
					right: '-900px'
				}, 0.8);
				t1.to(('#right-logo'), 0.2, {
					opacity: 0
				}, 0.7);
				t1.to(('#red-team-name'), 0.5, {
					text: '',
					ease: SteppedEase.easeIn
				}, 0.2);
				t1.to(('#red-team-score'), 0.2, {
					opacity: 0
				}, 0);
				isShowing = false;
			});

		}
	})
</script>
